<?xml version="1.0" encoding="UTF-8"?>
<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.omg.org/bpmn20" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:bpsim="http://www.bpsim.org/schemas/1.0" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:drools="http://www.jboss.org/drools" id="_OPNagErrEeSDE-F81n1vTA" xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd http://www.jboss.org/drools drools.xsd http://www.bpsim.org/schemas/1.0 bpsim.xsd" expressionLanguage="http://www.mvel.org/2.0" targetNamespace="http://www.omg.org/bpmn20" typeLanguage="http://www.java.com/javaTypes">
  <bpmn2:itemDefinition id="_OperationItem" structureRef="String"/>
  <bpmn2:itemDefinition id="_RequestorItem" structureRef="String"/>
  <bpmn2:itemDefinition id="_RepositoryItem" structureRef="String"/>
  <bpmn2:itemDefinition id="_ProjectItem" structureRef="String"/>
  <bpmn2:itemDefinition id="_ApprovedItem" structureRef="Boolean"/>
  <bpmn2:itemDefinition id="_RequiresApprovalItem" structureRef="Boolean"/>
  <bpmn2:itemDefinition id="__21151627-2E46-427E-AC6A-97B6C9619A09_in_operationInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__21151627-2E46-427E-AC6A-97B6C9619A09_in_requestorInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__21151627-2E46-427E-AC6A-97B6C9619A09_in_repositoryInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__21151627-2E46-427E-AC6A-97B6C9619A09_in_projectInputXItem" structureRef="String"/>
  <bpmn2:itemDefinition id="__21151627-2E46-427E-AC6A-97B6C9619A09_out_approvedOutputXItem" structureRef="Boolean"/>
  <bpmn2:process id="guvnor-asset-management.ApproveOperation" drools:packageName="org.jbpm" drools:version="1.0" name="ApproveOperation" isExecutable="true">
    <bpmn2:property id="Operation" itemSubjectRef="_OperationItem"/>
    <bpmn2:property id="Requestor" itemSubjectRef="_RequestorItem"/>
    <bpmn2:property id="Repository" itemSubjectRef="_RepositoryItem"/>
    <bpmn2:property id="Project" itemSubjectRef="_ProjectItem"/>
    <bpmn2:property id="Approved" itemSubjectRef="_ApprovedItem"/>
    <bpmn2:property id="RequiresApproval" itemSubjectRef="_RequiresApprovalItem"/>
    <bpmn2:startEvent id="processStartEvent" drools:bgcolor="#9acd32" drools:selectable="true" name="">
      <bpmn2:outgoing>_C0CD282C-C27C-484F-9F60-46E49A3731F0</bpmn2:outgoing>
    </bpmn2:startEvent>
    <bpmn2:businessRuleTask id="_7AA8E10A-8C6B-4C93-9A63-BE9EFC7E47AC" drools:selectable="true" drools:ruleFlowGroup="approval-rules" drools:scriptFormat="http://www.java.com/java" name="Is approval needed">
      <bpmn2:incoming>_C0CD282C-C27C-484F-9F60-46E49A3731F0</bpmn2:incoming>
      <bpmn2:outgoing>_BDE59A80-825D-4CB8-85C4-11B8E3132481</bpmn2:outgoing>
    </bpmn2:businessRuleTask>
    <bpmn2:sequenceFlow id="_C0CD282C-C27C-484F-9F60-46E49A3731F0" drools:bgcolor="#000000" drools:selectable="true" sourceRef="processStartEvent" targetRef="_7AA8E10A-8C6B-4C93-9A63-BE9EFC7E47AC"/>
    <bpmn2:exclusiveGateway id="_ED46320E-13D2-42FA-92FE-D4538BC6550B" drools:bgcolor="#f0e68c" drools:selectable="true" drools:bordercolor="#a67f00" drools:dg="" name="" gatewayDirection="Diverging">
      <bpmn2:incoming>_BDE59A80-825D-4CB8-85C4-11B8E3132481</bpmn2:incoming>
      <bpmn2:outgoing>_FBF1909D-74F9-46FF-9081-E2F7D459F737</bpmn2:outgoing>
      <bpmn2:outgoing>_05AE836F-95A6-4E74-95F8-DAB95270AC09</bpmn2:outgoing>
    </bpmn2:exclusiveGateway>
    <bpmn2:sequenceFlow id="_BDE59A80-825D-4CB8-85C4-11B8E3132481" drools:bgcolor="#000000" drools:selectable="true" sourceRef="_7AA8E10A-8C6B-4C93-9A63-BE9EFC7E47AC" targetRef="_ED46320E-13D2-42FA-92FE-D4538BC6550B"/>
    <bpmn2:userTask id="_21151627-2E46-427E-AC6A-97B6C9619A09" drools:selectable="true" drools:scriptFormat="http://www.java.com/java" name="Approve">
      <bpmn2:incoming>_FBF1909D-74F9-46FF-9081-E2F7D459F737</bpmn2:incoming>
      <bpmn2:outgoing>_299A8121-8BDA-4C59-805A-839D2079CB8D</bpmn2:outgoing>
      <bpmn2:ioSpecification id="_OPOBkErrEeSDE-F81n1vTA">
        <bpmn2:dataInput id="_21151627-2E46-427E-AC6A-97B6C9619A09_TaskNameInputX" name="TaskName"/>
        <bpmn2:dataInput id="_21151627-2E46-427E-AC6A-97B6C9619A09_in_operationInputX" drools:dtype="String" itemSubjectRef="__21151627-2E46-427E-AC6A-97B6C9619A09_in_operationInputXItem" name="in_operation"/>
        <bpmn2:dataInput id="_21151627-2E46-427E-AC6A-97B6C9619A09_in_requestorInputX" drools:dtype="String" itemSubjectRef="__21151627-2E46-427E-AC6A-97B6C9619A09_in_requestorInputXItem" name="in_requestor"/>
        <bpmn2:dataInput id="_21151627-2E46-427E-AC6A-97B6C9619A09_in_repositoryInputX" drools:dtype="String" itemSubjectRef="__21151627-2E46-427E-AC6A-97B6C9619A09_in_repositoryInputXItem" name="in_repository"/>
        <bpmn2:dataInput id="_21151627-2E46-427E-AC6A-97B6C9619A09_in_projectInputX" drools:dtype="String" itemSubjectRef="__21151627-2E46-427E-AC6A-97B6C9619A09_in_projectInputXItem" name="in_project"/>
        <bpmn2:dataInput id="_21151627-2E46-427E-AC6A-97B6C9619A09_GroupIdInputX" name="GroupId"/>
        <bpmn2:dataOutput id="_21151627-2E46-427E-AC6A-97B6C9619A09_out_approvedOutputX" drools:dtype="Boolean" itemSubjectRef="__21151627-2E46-427E-AC6A-97B6C9619A09_out_approvedOutputXItem" name="out_approved"/>
        <bpmn2:inputSet id="_OPOBkUrrEeSDE-F81n1vTA">
          <bpmn2:dataInputRefs>_21151627-2E46-427E-AC6A-97B6C9619A09_in_operationInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_21151627-2E46-427E-AC6A-97B6C9619A09_in_requestorInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_21151627-2E46-427E-AC6A-97B6C9619A09_in_repositoryInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_21151627-2E46-427E-AC6A-97B6C9619A09_in_projectInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_21151627-2E46-427E-AC6A-97B6C9619A09_TaskNameInputX</bpmn2:dataInputRefs>
          <bpmn2:dataInputRefs>_21151627-2E46-427E-AC6A-97B6C9619A09_GroupIdInputX</bpmn2:dataInputRefs>
        </bpmn2:inputSet>
        <bpmn2:outputSet id="_OPOBkkrrEeSDE-F81n1vTA">
          <bpmn2:dataOutputRefs>_21151627-2E46-427E-AC6A-97B6C9619A09_out_approvedOutputX</bpmn2:dataOutputRefs>
        </bpmn2:outputSet>
      </bpmn2:ioSpecification>
      <bpmn2:dataInputAssociation id="_OPOBk0rrEeSDE-F81n1vTA">
        <bpmn2:targetRef>_21151627-2E46-427E-AC6A-97B6C9619A09_TaskNameInputX</bpmn2:targetRef>
        <bpmn2:assignment id="_OPOBlErrEeSDE-F81n1vTA">
          <bpmn2:from xsi:type="bpmn2:tFormalExpression" id="_OPOBlUrrEeSDE-F81n1vTA">ApproveOperation</bpmn2:from>
          <bpmn2:to xsi:type="bpmn2:tFormalExpression" id="_OPOBlkrrEeSDE-F81n1vTA">_21151627-2E46-427E-AC6A-97B6C9619A09_TaskNameInputX</bpmn2:to>
        </bpmn2:assignment>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataInputAssociation id="_OPOBl0rrEeSDE-F81n1vTA">
        <bpmn2:sourceRef>Operation</bpmn2:sourceRef>
        <bpmn2:targetRef>_21151627-2E46-427E-AC6A-97B6C9619A09_in_operationInputX</bpmn2:targetRef>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataInputAssociation id="_OPOBmErrEeSDE-F81n1vTA">
        <bpmn2:sourceRef>Requestor</bpmn2:sourceRef>
        <bpmn2:targetRef>_21151627-2E46-427E-AC6A-97B6C9619A09_in_requestorInputX</bpmn2:targetRef>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataInputAssociation id="_OPOBmUrrEeSDE-F81n1vTA">
        <bpmn2:sourceRef>Repository</bpmn2:sourceRef>
        <bpmn2:targetRef>_21151627-2E46-427E-AC6A-97B6C9619A09_in_repositoryInputX</bpmn2:targetRef>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataInputAssociation id="_OPOBmkrrEeSDE-F81n1vTA">
        <bpmn2:sourceRef>Project</bpmn2:sourceRef>
        <bpmn2:targetRef>_21151627-2E46-427E-AC6A-97B6C9619A09_in_projectInputX</bpmn2:targetRef>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataInputAssociation id="_OPOBm0rrEeSDE-F81n1vTA">
        <bpmn2:targetRef>_21151627-2E46-427E-AC6A-97B6C9619A09_GroupIdInputX</bpmn2:targetRef>
        <bpmn2:assignment id="_OPOBnErrEeSDE-F81n1vTA">
          <bpmn2:from xsi:type="bpmn2:tFormalExpression" id="_OPOBnUrrEeSDE-F81n1vTA"><![CDATA[kiemgmt]]></bpmn2:from>
          <bpmn2:to xsi:type="bpmn2:tFormalExpression" id="_OPOBnkrrEeSDE-F81n1vTA">_21151627-2E46-427E-AC6A-97B6C9619A09_GroupIdInputX</bpmn2:to>
        </bpmn2:assignment>
      </bpmn2:dataInputAssociation>
      <bpmn2:dataOutputAssociation id="_OPOBn0rrEeSDE-F81n1vTA">
        <bpmn2:sourceRef>_21151627-2E46-427E-AC6A-97B6C9619A09_out_approvedOutputX</bpmn2:sourceRef>
        <bpmn2:targetRef>Approved</bpmn2:targetRef>
      </bpmn2:dataOutputAssociation>
    </bpmn2:userTask>
    <bpmn2:sequenceFlow id="_FBF1909D-74F9-46FF-9081-E2F7D459F737" drools:bgcolor="#000000" drools:selectable="true" sourceRef="_ED46320E-13D2-42FA-92FE-D4538BC6550B" targetRef="_21151627-2E46-427E-AC6A-97B6C9619A09">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression" id="_OPOBoErrEeSDE-F81n1vTA" language="http://www.java.com/java"><![CDATA[return  KieFunctions.isTrue(RequiresApproval);]]></bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>
    <bpmn2:sequenceFlow id="_05AE836F-95A6-4E74-95F8-DAB95270AC09" drools:bgcolor="#000000" drools:selectable="true" sourceRef="_ED46320E-13D2-42FA-92FE-D4538BC6550B" targetRef="_94AE378C-175E-4641-82A5-96B12B9DE1AD">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression" id="_OPOBoUrrEeSDE-F81n1vTA" language="http://www.java.com/java"><![CDATA[return  KieFunctions.isFalse(RequiresApproval) || KieFunctions.isNull(RequiresApproval);]]></bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>
    <bpmn2:endEvent id="_0D027563-37EA-40A7-82DB-98FA027921B8" drools:bgcolor="#ff6347" drools:selectable="true" name="">
      <bpmn2:incoming>_299A8121-8BDA-4C59-805A-839D2079CB8D</bpmn2:incoming>
    </bpmn2:endEvent>
    <bpmn2:sequenceFlow id="_299A8121-8BDA-4C59-805A-839D2079CB8D" drools:bgcolor="#000000" drools:selectable="true" sourceRef="_21151627-2E46-427E-AC6A-97B6C9619A09" targetRef="_0D027563-37EA-40A7-82DB-98FA027921B8"/>
    <bpmn2:scriptTask id="_94AE378C-175E-4641-82A5-96B12B9DE1AD" drools:selectable="true" name="Auto approve if not set" scriptFormat="http://www.java.com/java">
      <bpmn2:incoming>_05AE836F-95A6-4E74-95F8-DAB95270AC09</bpmn2:incoming>
      <bpmn2:outgoing>_278945EB-7C3D-4176-BD21-88E419944A2E</bpmn2:outgoing>
      <bpmn2:script><![CDATA[if (kcontext.getVariable("Approved") == null) {
    kcontext.setVariable("Approved", true); 
}]]></bpmn2:script>
    </bpmn2:scriptTask>
    <bpmn2:endEvent id="_4E1A8B09-834F-402C-B956-804BED2FE1DB" drools:bgcolor="#ff6347" drools:selectable="true" name="">
      <bpmn2:incoming>_278945EB-7C3D-4176-BD21-88E419944A2E</bpmn2:incoming>
    </bpmn2:endEvent>
    <bpmn2:sequenceFlow id="_278945EB-7C3D-4176-BD21-88E419944A2E" drools:bgcolor="#000000" drools:selectable="true" sourceRef="_94AE378C-175E-4641-82A5-96B12B9DE1AD" targetRef="_4E1A8B09-834F-402C-B956-804BED2FE1DB"/>
  </bpmn2:process>
  <bpmndi:BPMNDiagram id="_OPOBokrrEeSDE-F81n1vTA">
    <bpmndi:BPMNPlane id="_OPOBo0rrEeSDE-F81n1vTA" bpmnElement="guvnor-asset-management.ApproveOperation">
      <bpmndi:BPMNShape id="_OPOBpErrEeSDE-F81n1vTA" bpmnElement="processStartEvent">
        <dc:Bounds height="30.0" width="30.0" x="120.0" y="165.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_OPOBpUrrEeSDE-F81n1vTA" bpmnElement="_7AA8E10A-8C6B-4C93-9A63-BE9EFC7E47AC">
        <dc:Bounds height="80.0" width="100.0" x="195.0" y="140.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="_OPOooErrEeSDE-F81n1vTA" bpmnElement="_C0CD282C-C27C-484F-9F60-46E49A3731F0">
        <di:waypoint xsi:type="dc:Point" x="135.0" y="180.0"/>
        <di:waypoint xsi:type="dc:Point" x="245.0" y="180.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="_OPOooUrrEeSDE-F81n1vTA" bpmnElement="_ED46320E-13D2-42FA-92FE-D4538BC6550B">
        <dc:Bounds height="40.0" width="40.0" x="340.0" y="160.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="_OPOookrrEeSDE-F81n1vTA" bpmnElement="_BDE59A80-825D-4CB8-85C4-11B8E3132481">
        <di:waypoint xsi:type="dc:Point" x="245.0" y="180.0"/>
        <di:waypoint xsi:type="dc:Point" x="360.0" y="180.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="_OPOoo0rrEeSDE-F81n1vTA" bpmnElement="_21151627-2E46-427E-AC6A-97B6C9619A09">
        <dc:Bounds height="80.0" width="100.0" x="425.0" y="140.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="_OPOopErrEeSDE-F81n1vTA" bpmnElement="_FBF1909D-74F9-46FF-9081-E2F7D459F737">
        <di:waypoint xsi:type="dc:Point" x="360.0" y="180.0"/>
        <di:waypoint xsi:type="dc:Point" x="475.0" y="180.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="_OPOopUrrEeSDE-F81n1vTA" bpmnElement="_05AE836F-95A6-4E74-95F8-DAB95270AC09">
        <di:waypoint xsi:type="dc:Point" x="360.0" y="180.0"/>
        <di:waypoint xsi:type="dc:Point" x="360.0" y="314.0"/>
        <di:waypoint xsi:type="dc:Point" x="495.0" y="310.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="_OPOopkrrEeSDE-F81n1vTA" bpmnElement="_0D027563-37EA-40A7-82DB-98FA027921B8">
        <dc:Bounds height="28.0" width="28.0" x="564.0" y="160.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="_OPOop0rrEeSDE-F81n1vTA" bpmnElement="_299A8121-8BDA-4C59-805A-839D2079CB8D">
        <di:waypoint xsi:type="dc:Point" x="475.0" y="180.0"/>
        <di:waypoint xsi:type="dc:Point" x="578.0" y="174.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="_OPOoqErrEeSDE-F81n1vTA" bpmnElement="_94AE378C-175E-4641-82A5-96B12B9DE1AD">
        <dc:Bounds height="80.0" width="100.0" x="445.0" y="270.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_OPOoqUrrEeSDE-F81n1vTA" bpmnElement="_4E1A8B09-834F-402C-B956-804BED2FE1DB">
        <dc:Bounds height="28.0" width="28.0" x="590.0" y="296.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="_OPOoqkrrEeSDE-F81n1vTA" bpmnElement="_278945EB-7C3D-4176-BD21-88E419944A2E">
        <di:waypoint xsi:type="dc:Point" x="495.0" y="310.0"/>
        <di:waypoint xsi:type="dc:Point" x="604.0" y="310.0"/>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn2:definitions>
